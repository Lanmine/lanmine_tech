---
all:
  children:
    infrastructure:
      hosts:
        opnsense:
          ansible_host: 10.0.10.1
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.opnsense_user }}"
          ansible_connection: ssh

        proxmox:
          ansible_host: 10.0.10.5
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.proxmox_user }}"
          ansible_connection: ssh

        vault:
          ansible_host: 10.0.10.21
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.vault_user }}"
          ansible_connection: ssh

        runner:
          ansible_host: 10.0.10.22
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.runner_user }}"
          ansible_connection: ssh

        authentik:
          ansible_host: 10.0.10.25
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.authentik_user }}"
          ansible_connection: ssh

        postgres:
          ansible_host: 10.0.10.23
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.postgres_user }}"
          ansible_connection: ssh

        akvorado:
          ansible_host: 10.0.10.26
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.akvorado_user }}"
          ansible_connection: ssh

        n8n:
          ansible_host: 10.0.10.27
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.n8n_user }}"
          ansible_connection: ssh

        panda9000:
          ansible_host: 10.0.10.28
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.panda9000_user }}"
          ansible_connection: ssh

        lancache:
          ansible_host: 10.0.20.2
          ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/ssh', validate_certs=true).secret.lancache_user }}"
          ansible_connection: ssh

    # Linux VMs that use rsyslog for log forwarding
    linux_vms:
      hosts:
        vault:
        runner:
        authentik:
        postgres:
        akvorado:
        n8n:
        panda9000:
        lancache:

    # n8n workflow automation servers
    n8n_servers:
      hosts:
        n8n:

    # PANDA9000 voice interface servers
    panda9000_servers:
      hosts:
        panda9000:

    # LANcache servers for game download caching
    lancache_servers:
      hosts:
        lancache:

    # Cisco network switches
    # Note: Switches are now managed via NetBox dynamic inventory (inventory/netbox.netbox.yml)
    # NetBox provides device inventory, IPs, and metadata
    # This group defines connection variables for all Cisco switches from NetBox
    cisco_switches:
      vars:
        ansible_network_os: cisco.ios.ios
        ansible_connection: ansible.netcommon.network_cli
        ansible_become: true
        ansible_become_method: enable
        # Credentials from Vault (applied to all switches)
        ansible_user: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/switches/global', url='https://vault-01.lionfish-caiman.ts.net:8200').secret.ansible_user }}"
        ansible_password: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/switches/global', url='https://vault-01.lionfish-caiman.ts.net:8200').secret.ansible_password }}"
        ansible_become_password: "{{ lookup('community.hashi_vault.vault_kv2_get', 'infrastructure/switches/global', url='https://vault-01.lionfish-caiman.ts.net:8200').secret.enable_secret }}"
      children:
        # Include all switches from NetBox with manufacturer=Cisco
        manufacturers_cisco:
